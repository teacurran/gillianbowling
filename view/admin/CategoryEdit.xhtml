<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
		"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
				xmlns:s="http://jboss.com/products/seam/taglib"
				xmlns:ui="http://java.sun.com/jsf/facelets"
				xmlns:f="http://java.sun.com/jsf/core"
				xmlns:h="http://java.sun.com/jsf/html"
				xmlns:a4j="http://richfaces.org/a4j"
				xmlns:rich="http://richfaces.org/rich"
				template="layout/template.xhtml">

	<ui:define name="body">

		<h:form id="category" styleClass="edit">

			<rich:panel>
				<f:facet name="header">#{categoryHome.managed ? 'Edit' : 'Add'} Category</f:facet>


				<s:decorate id="idField" template="layout/edit.xhtml" rendered="#{categoryHome.managed}">
					<ui:define name="label">Id</ui:define>
					<h:outputText value="#{categoryHome.instance.id}"/>
				</s:decorate>

				<s:decorate id="parentField" template="layout/edit.xhtml">
					<ui:define name="label">Parent</ui:define>
					<h:selectOneListbox id="brandName" value="#{categoryHome.instance.parent}" styleClass="clientSelectBox" size="1" required="false" immediate="true">
						<s:selectItems value="#{categoryHome.availableParents}" var="_cat" label="#{_cat.name}" noSelectionLabel="please choose..."/>
						<s:convertEntity/>
					</h:selectOneListbox>
					Leaving blank will make this Category available as a parent.
				</s:decorate>

				<s:decorate id="nameField" template="layout/edit.xhtml">
					<ui:define name="label">Name</ui:define>
					<h:inputText id="name"
								 size="100"
								 maxlength="100"
								 value="#{categoryHome.instance.name}" required="true">
						<a4j:support event="onblur" reRender="nameField" bypassUpdates="true" ajaxSingle="true"/>
					</h:inputText>
				</s:decorate>

				<s:decorate id="codeField" template="layout/edit.xhtml">
					<ui:define name="label">Code</ui:define>
					<h:inputText id="code"
								 size="100"
								 maxlength="100"
								 value="#{categoryHome.instance.code}" required="true">
						<a4j:support event="onblur" reRender="codeField" bypassUpdates="true" ajaxSingle="true"/>
					</h:inputText>
				</s:decorate>

				<s:decorate id="rankField" template="layout/edit.xhtml">
					<ui:define name="label">Rank</ui:define>
					<h:inputText id="rank"
								 size="5"
								 maxlength="10"
								 value="#{categoryHome.instance.rank}">
						<a4j:support event="onblur" reRender="rankField" bypassUpdates="true" ajaxSingle="true"/>
					</h:inputText>
				</s:decorate>

				<s:decorate id="photoSortField" template="layout/edit.xhtml">
					<ui:define name="label">Photo Sorting</ui:define>
					<rich:orderingList value="#{categoryHome.photos}" var="_photo" listHeight="500" listWidth="300">
						<rich:column  width="180">
							<f:facet name="header">
								<h:outputText value="Content" />
							</f:facet>
							<h:outputText rendered="#{not empty _photo.fileName}">
								<img src="#{request.contextPath}/media/50x/#{_photo.fileName}" class="image" alt="#{_photo.description}"/>
							</h:outputText>
							<h:outputText rendered="#{empty _photo.fileName}" value="Text Block"/>
						</rich:column>
						<s:convertEntity/>
					</rich:orderingList>
				</s:decorate>

				<div style="clear:both">
					<span class="required">*</span>
					required fields
				</div>

			</rich:panel>

			<div class="actionButtons">

				<h:commandButton id="save"
								 value="Save"
								 action="#{categoryHome.persist}"
								 disabled="#{!categoryHome.wired}"
								 rendered="#{!categoryHome.managed}"/>

				<h:commandButton id="update"
								 value="Save"
								 action="#{categoryHome.update}"
								 rendered="#{categoryHome.managed}"/>

				<h:commandButton id="delete"
								 value="Delete"
								 action="#{categoryHome.remove}"
								 immediate="true"
								 rendered="#{categoryHome.managed}"/>

				<s:button id="cancelEdit"
						  value="Cancel"
						  propagation="end"
						  view="/admin/Category.xhtml"
						  rendered="#{categoryHome.managed}"/>

				<s:button id="cancelAdd"
						  value="Cancel"
						  propagation="end"
						  view="/admin/#{empty categoryFrom ? 'CategoryList' : categoryFrom}.xhtml"
						  rendered="#{!categoryHome.managed}"/>

			</div>
		</h:form>

	</ui:define>

</ui:composition>
