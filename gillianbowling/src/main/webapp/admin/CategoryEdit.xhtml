<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:ui="http://java.sun.com/jsf/facelets"
	  xmlns:h="http://java.sun.com/jsf/html"
	  xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:p="http://primefaces.org/ui">
<ui:composition template="layout/template.xhtml">
	<ui:define name="body">

		<h:form id="category" styleClass="edit">

			<p:panel>
				<f:facet name="header">#{categoryManager.managed ? 'Edit' : 'Add'} Category</f:facet>


				<ui:decorate id="idField" template="layout/edit.xhtml" rendered="#{categoryManager.managed}">
					<ui:define name="label">Id</ui:define>
					<h:outputText value="#{categoryManager.instance.id}"/>
				</ui:decorate>

				<ui:decorate id="parentField" template="layout/edit.xhtml">
					<ui:define name="label">Parent</ui:define>
					<h:selectOneListbox id="brandName" value="#{categoryManager.instance.parent}" styleClass="clientSelectBox" size="1" required="false" immediate="true">
						<f:selectItems value="#{categoryManager.availableParents}" var="_cat" label="#{_cat.name}" noSelectionLabel="please choose..."/>
						<s:convertEntity/>
					</h:selectOneListbox>
					Leaving blank will make this Category available as a parent.
				</ui:decorate>

				<ui:decorate id="nameField" template="layout/edit.xhtml">
					<ui:define name="label">Name</ui:define>
					<h:inputText id="name"
								 size="100"
								 maxlength="100"
								 value="#{categoryManager.instance.name}" required="true">
						<a4j:support event="onblur" reRender="nameField" bypassUpdates="true" ajaxSingle="true"/>
					</h:inputText>
				</ui:decorate>

				<ui:decorate id="codeField" template="layout/edit.xhtml">
					<ui:define name="label">Code</ui:define>
					<h:inputText id="code"
								 size="100"
								 maxlength="100"
								 value="#{categoryManager.instance.code}" required="true">
						<a4j:support event="onblur" reRender="codeField" bypassUpdates="true" ajaxSingle="true"/>
					</h:inputText>
				</ui:decorate>

				<ui:decorate id="rankField" template="layout/edit.xhtml">
					<ui:define name="label">Rank</ui:define>
					<h:inputText id="rank"
								 size="5"
								 maxlength="10"
								 value="#{categoryManager.instance.rank}">
						<a4j:support event="onblur" reRender="rankField" bypassUpdates="true" ajaxSingle="true"/>
					</h:inputText>
				</ui:decorate>

				<ui:decorate id="photoSortField" template="layout/edit.xhtml">
					<ui:define name="label">Photo Sorting</ui:define>
					<rich:orderingList value="#{categoryManager.photos}" var="_photo" listHeight="500" listWidth="300">
						<p:column  width="180">
							<f:facet name="header">
								<h:outputText value="Content" />
							</f:facet>
							<h:outputText rendered="#{not empty _photo.fileName}">
								<img src="#{request.contextPath}/media/50x/#{_photo.fileName}" class="image" alt="#{_photo.description}"/>
							</h:outputText>
							<h:outputText rendered="#{empty _photo.fileName}" value="Text Block"/>
						</p:column>
						<s:convertEntity/>
					</rich:orderingList>
				</ui:decorate>

				<div style="clear:both">
					<span class="required">*</span>
					required fields
				</div>

			</p:panel>

			<div class="actionButtons">

				<h:commandButton id="save"
								 value="Save"
								 action="#{categoryManager.persist}"
								 disabled="#{!categoryManager.wired}"
								 rendered="#{!categoryManager.managed}"/>

				<h:commandButton id="update"
								 value="Save"
								 action="#{categoryManager.update}"
								 rendered="#{categoryManager.managed}"/>

				<h:commandButton id="delete"
								 value="Delete"
								 action="#{categoryManager.remove}"
								 immediate="true"
								 rendered="#{categoryManager.managed}"/>

				<s:button id="cancelEdit"
						  value="Cancel"
						  propagation="end"
						  view="/admin/Category.xhtml"
						  rendered="#{categoryManager.managed}"/>

				<s:button id="cancelAdd"
						  value="Cancel"
						  propagation="end"
						  view="/admin/#{empty categoryFrom ? 'CategoryList' : categoryFrom}.xhtml"
						  rendered="#{!categoryManager.managed}"/>

			</div>
		</h:form>

	</ui:define>

</ui:composition>

</html>